<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width-device0-width, initial-scale = 1.0">
        <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="index.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700&display=swap" rel="stylesheet">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="topnav">
            <a href="#purpose">Sources of CO2 Emission</a>
            <a href="#world">C02 Emissions</a>
            <a href="#malaysia">Temperature</a>
        </div>
        <div class="row">
            <div class="col">
                <div class="h1-title" id="purpose">World C02 Emissions</div>
            </div>
            <div class="col">
                <div class="h3-title">A breakdown of the sources of C02 Emissions across the world</div>
            </div>
            <div class="col-sm-4">
                <div class="title-container-child">
                    <div class="h2-title">About</div>
                    <p class="p-section-title">
                        The purpose of this visualization is to visualise <b>global CO2 emissions</b>, <b>their sources </b>
                        and it's <b>effects on global temperature</b>. 
                        <br><br>Firstly, this visualization will be exploring the trend of global CO2 
                        <br>emissions over time. We will then explore the sources of CO2 emissions.  
                        Then, the effects of CO2 emission on global temperature will be visualised.
                        
                        <br><br>Lastly, we will be exploring Malaysia's CO2 emissions and how it has affected the country's temperature
                    </p>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="title-container-child">
                    <div class="h2-title">What is CO2 Emission?</div>
                    <p class="p-section-title">
                        CO2 emission is defined as the release of Carbon Dioxide 
                        <br>into the atmosphere
                        <br><br>CO2 emission causes a variety of global problems. Most prominently, 
                        
                        <br>global warming, which causes the greenhouse effect, resulting in 
                        <br>increasing global temperature.
                        <br><br>From there, rising global temperatures causes a cascading array of problems 
                    </p>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="h2-title">Keywords</div>
                <p class="p-section-title">
                    <b>Kilotons</b> : <i>A unit of weight, 1000 kilograms</i>
                    <br><br><b>Celsius</b> : <i>A unit of temperature</i>
                    <br><br><b>CO2</b> : <i>Carbon dioxide</i>
                    <br><br><b>Emission</b> : <i>Release of a substance</i>
                    <br><br><b>Per capita</b> : <i>Average per person</i>
                </p>
            </div>
        </div>
        <hr style="border-width: 0.2rem;border-color: black; margin: 2% 5% 0% 5%;">
        <div class="parent-container" >
            <div class="row">
                <div class="col-sm-6">
                    <div class="col" style="padding-bottom: 1%;">
                        <div class="h1-section"><b style="font-size: 2.95rem;">1.</b><br>Global CO2 Emissions per capita from 1961 to 2019</div>
                        <div class="p-section">
                            There is a big increase in CO2 emission per capita. Particularly,
                            <b>Saudi Arabia, Australia</b> and <b>Asia</b> are all producing close to 20 kilotons of CO2 in 2019.
                        </div>
                    </div>
                    <div class="chart-container">
                        <div id="co2_emissions_total"></div>
                        <script type="text/javascript">
                            var yourVlSpec = 
                            {
                                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                                "width": "container",
                                "height": "container",
                                "projection": {
                                    "type": "equalEarth",
                                    "center": {"expr": "center_to"},
                                    "scale": {"expr": "zoom_level"}
                                },
                                "params": [
                                    {
                                    "name": "Year_selection",
                                    "value": 1961,
                                    "bind": {
                                        "input": "range",
                                        "min": 1961,
                                        "max": 2019,
                                        "step": 1,
                                        "name": "Year: "
                                    }
                                    },
                                    {
                                    "name": "zoom_level",
                                    "value": 100,
                                    "bind": {
                                        "input": "range",
                                        "min": 100,
                                        "max": 650,
                                        "step": 50,
                                        "name": "Zoom: "
                                    }
                                    },
                                    {
                                    "name": "center_to",
                                    "value": [0, 0],
                                    "bind": {
                                        "input": "select",
                                        "options": [
                                        [0, 0],
                                        [30, 0],
                                        [90, 20],
                                        [135, -25],
                                        [35, 55],
                                        [-95, 45],
                                        [-60, -20],
                                        [100,0]
                                        ],
                                        "labels": [
                                        "World",
                                        "Africa",
                                        "Asia",
                                        "Australia",
                                        "Europe",
                                        "North America",
                                        "South America",
                                        "Malaysia"
                                        ],
                                        "name": "Map Centre: "
                                    }
                                    }
                                ],
                                "layer": [
                                    {
                                    "data": {
                                        "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_admin_0_countries.json",
                                        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
                                    },
                                    "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
                                    },
                                    {
                                    "data": {
                                        "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_ocean.topojson",
                                        "format": {"type": "topojson", "feature": "oceans"}
                                    },
                                    "mark": {"type": "geoshape", "fill": "skyblue", "stroke": "null"}
                                    },
                                    {
                                    "data": {
                                        "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_graticules_30.json",
                                        "format": {"type": "topojson", "feature": "ne_110m_graticules_30"}
                                    },
                                    "mark": {"type": "geoshape", "fill": null, "stroke": "lightgrey"}
                                    },
                                    {
                                    "data": {
                                        "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179A2/main/data/global_emissions_cleaned_time_percapita.csv"
                                    },
                                    "transform": [
                                        {
                                        "lookup": "Country",
                                        "from": {
                                            "data": {
                                            "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_admin_0_countries.json",
                                            "format": {
                                                "type": "topojson",
                                                "feature": "ne_110m_admin_0_countries"
                                            }
                                            },
                                            "key": "properties.NAME"
                                        },
                                        "as": "geo"
                                        },
                                        {"filter": "datum.Year == Year_selection"}
                                    ],
                                    "mark": {"type": "geoshape"},
                                    "encoding": {
                                        "description": {"field": "Country"},
                                        "shape": {"field": "geo", "type": "geojson"},
                                        "color": {"field":"Total", 
                                        "type":"quantitative",
                                        "scale" : {
                                        "type" : "threshold",
                                        "domain": [5,10,15,20],
                                        "scheme": "yelloworangered"
                                            },
                                        "legend":{
                                            "title":"CO2 Emissions per capita",
                                            "orient":"top"
                                            },
                                        },
                                        "tooltip": [
                                        {"field": "Country", "type": "nominal", "title": "Country"},
                                        {"field": "Total", "type": "quantitative","format":".2f","title":"CO2 Emissions per capita in kilotons"},
                                        {"field":"Year","type":"quantitative"}
                                        ]
                                    }
                                    },
                                    {
                                    "data": {
                                        "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179A2/main/data/continents.csv"
                                    },
                                    "mark": {
                                        "type": "text",
                                        "color": "black",
                                        "fontWeight": "bolder",
                                        "fontSize": 11
                                    },
                                    "encoding": {
                                        "text": {"field": "Continent", "type": "nominal"},
                                        "latitude": {"field": "Latitude", "type": "quantitative"},
                                        "longitude": {"field": "Longitude", "type": "quantitative"}
                                    }
                                    }
                                ]
                            } 
                            vegaEmbed('#co2_emissions_total ', yourVlSpec);
                        </script>
                    </div>
                </div> 
                <div class="col-sm-6">
                    <div class="col" style="padding-bottom: 1%;">
                        <div class="h1-section"><b style="font-size: 2.95rem;">2.</b><br>CO2 Emission Source by Country</div>
                        <div class="p-section">
                            We can see that over the span of 59 years, <b>Oil and Coal</b> make up over 90% of the global CO2 Emissions.
                            <br><b>Malaysia</b> has significantly increase it's use of <b>Coal</b>, as shown below
                        </div>
                    </div>
                    <!-- donut chart -->
                    <div class="chart-container">
                        <div id="emission_donutchart"></div>
                        <script type="text/javascript">
                            var yourVlSpec = 
                            {
                                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                                "width":"container",
                                "height":"container",
                                "data": {
                                    "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179A2/main/data/emission_source_cleaned.csv"
                                },
                                "params": [
                                    {
                                        "name": "Country",
                                        "bind": {
                                            "input": "select",
                                            "options": [
                                                "All countries",
                                                "Cambodia",
                                                "Indonesia",
                                                "Australia",
                                                "Brunei Darussalam",
                                                "Malaysia",
                                                "Myanmar",
                                                "China",
                                                "Singapore",
                                                "Thailand",
                                                "Viet Nam"
                                            ]
                                        }
                                    },
                                    {
                                        "name": "Year_selection",
                                        "value": 1961,
                                        "bind": {
                                        "input": "range",
                                        "min": 1961,
                                        "max": 2019,
                                        "step": 1,
                                        "name": "Year"
                                        }
                                    }
                        
                                ],
                                "transform": [
                                    {
                                        "filter": "if(Country !=null, datum.Country == Country, datum.Country == 'All countries') & datum.Year == Year_selection"
                                    }
                                ],
                                "encoding": {
                                    "theta": {
                                        "field": "value", 
                                        "type": "quantitative",
                                        "stack": true
                                    },
                                    "color": {
                                        "field": "variable", 
                                        "type": "ordinal",
                                        "scale": {"scheme": "blues"},
                                        "title": "Emission Source",
                                        "legend": {
                                            "labelColor": "black",
                                            "titleColor": "black",
                                            "labelFontSize":15,
                                            "titleFontSize":20,
                                            "orient":"top-left"
                                        }
                                    },
                                    "tooltip": [
                                        {"field": "variable", "type": "nominal", "title": "Emission Source:"},
                                        {"field": "value", "type": "quantitative", "title": "Percentage of Emission:","format":".2f"}
                                    ]
                                },
                                "layer": [
                                    {
                                        "mark": {"type": "arc", "outerRadius": 150, "innerRadius": 100}
                                    },
                                    {
                                        "mark": {
                                            "type": "text", 
                                            "radius": 190,
                                            "size":20,
                                            "fontWeight":"bold"
                                        },
                                        "encoding": {
                                            "text": {"field": "value", "type": "quantitative","format":".2f"}
                                        }
                                    },
                                    {
                                        "mark": {"type": "text","size":25},
                                        "encoding": {
                                            "opacity": {"value": 1},
                                            "color": {"value": "black"},
                                            "text": {"value": "C02 Emissions"}
                                        }
                                    }
                                ],
                                "config": {
                                    "background": "white",
                                    "view": {"stroke": "transparent"}
                                } 
                            }    
                            vegaEmbed('#emission_donutchart ', yourVlSpec);
                        </script>
                    </div>
                </div>
            </div>
        </div>  
        <div class="parent-container">     
            <div class="row">
                <div class="col">
                    <div class="h1-section" id="purpose"><b style="font-size: 2.95rem;">3.</b><br>Sources of CO2 Emission by Continent in 2019</div>
                    <div class="p-section"><b>North America</b> has the highest CO2 emissions in 2019. <b>Oil</b> is the biggest 
                        contributor of CO2 emissions followed by Coal and Cement
                    </div>
                </div>
                <div class="col-sm-3"></div>
                <div class="col-sm-6" id="sources_total">
                    <!-- <div class="chart-container" style="width: 100%;"> -->
                        <!-- <div id="sources_total" style="margin-left: 2%;"></div> -->
                        <script type="text/javascript">
                            var yourVlSpec = 
                            {
                                "$schema": "https://vega.github.io/schema/vega/v5.0.json",
                                "width": 800,
                                "height": 580,
                                "data": [
                                    {
                                    "name": "emission_types",
                                    "values": {
                                        "aggregations": {
                                        "table": {
                                            "buckets": [
                                            {
                                                "key": {"stk1": "Africa", "stk2": "Coal"},
                                                "doc_count": 0.2522,
                                                "stk1": "Africa",
                                                "stk2": "Coal",
                                                "size": 0.2522
                                            },
                                            {
                                                "key": {"stk1": "Africa", "stk2": "Oil"},
                                                "doc_count": 0.7360,
                                                "stk1": "Africa",
                                                "stk2": "Oil",
                                                "size": 0.7360
                                            },
                                            {
                                                "key": {"stk1": "Africa", "stk2": "Cement"},
                                                "doc_count": 0.0451,
                                                "stk1": "Africa",
                                                "stk2": "Cement",
                                                "size": 0.0451
                                            },
                                            {
                                                "key": {"stk1": "Asia", "stk2": "Coal"},
                                                "doc_count": 1.3464,
                                                "stk1": "Asia",
                                                "stk2": "Coal",
                                                "size": 1.3464
                                            },
                                            {
                                                "key": {"stk1": "Asia", "stk2": "Oil"},
                                                "doc_count": 2.0429,
                                                "stk1": "Asia",
                                                "stk2": "Oil",
                                                "size": 2.0429
                                            },
                                            {
                                                "key": {"stk1": "Asia", "stk2": "Cement"},
                                                "doc_count": 0.2112,
                                                "stk1": "Asia",
                                                "stk2": "Cement",
                                                "size": 0.2112
                                            },
                                            {
                                                "key": {"stk1": "Oceania", "stk2": "Coal"},
                                                "doc_count": 0.8630,
                                                "stk1": "Australia",
                                                "stk2": "Coal",
                                                "size": 0.8630
                                            },
                                            {
                                                "key": {"stk1": "Oceania", "stk2": "Oil"},
                                                "doc_count": 3.3333,
                                                "stk1": "Australia",
                                                "stk2": "Oil",
                                                "size": 3.3333
                                            },
                                            {
                                                "key": {"stk1": "Oceania", "stk2": "Cement"},
                                                "doc_count": 0.0160,
                                                "stk1": "Australia",
                                                "stk2": "Cement",
                                                "size": 0.0160
                                            },
                                            {
                                                "key": {"stk1": "Europe", "stk2": "Coal"},
                                                "doc_count": 1.4792,
                                                "stk1": "Europe",
                                                "stk2": "Coal",
                                                "size": 1.4792
                                            },
                                            {
                                                "key": {"stk1": "Europe", "stk2": "Oil"},
                                                "doc_count": 3.2563,
                                                "stk1": "Europe",
                                                "stk2": "Oil",
                                                "size": 3.2563
                                            },
                                            {
                                                "key": {"stk1": "Europe", "stk2": "Cement"},
                                                "doc_count": 0.1823,
                                                "stk1": "Europe",
                                                "stk2": "Cement",
                                                "size": 0.1823
                                            },
                                            {
                                                "key": {"stk1": "North America", "stk2": "Coal"},
                                                "doc_count": 0.1979,
                                                "stk1": "North America",
                                                "stk2": "Coal",
                                                "size": 0.1979
                                            },
                                            {
                                                "key": {"stk1": "North America", "stk2": "Oil"},
                                                "doc_count": 4.5871,
                                                "stk1": "North America",
                                                "stk2": "Oil",
                                                "size": 4.5871
                                            },
                                            {
                                                "key": {"stk1": "North America", "stk2": "Cement"},
                                                "doc_count": 0.0479,
                                                "stk1": "North America",
                                                "stk2": "Cement",
                                                "size": 0.0479
                                            },
                                            {
                                                "key": {"stk1": "South America", "stk2": "Coal"},
                                                "doc_count": 0.1864,
                                                "stk1": "South America",
                                                "stk2": "Coal",
                                                "size": 0.1864
                                            },
                                            {
                                                "key": {"stk1": "South America", "stk2": "Oil"},
                                                "doc_count": 1.9281,
                                                "stk1": "South America",
                                                "stk2": "Oil",
                                                "size": 1.9281
                                            },
                                            {
                                                "key": {"stk1": "South America", "stk2": "Cement"},
                                                "doc_count": 0.0909,
                                                "stk1": "South America",
                                                "stk2": "Cement",
                                                "size": 0.0909
                                            }
                                            ]
                                        }
                                        }
                                    },
                                    "format": {"property": "aggregations.table.buckets"},
                                    "transform": [
                                        {"type": "formula", "expr": "datum.key.stk1", "as": "stk1"},
                                        {"type": "formula", "expr": "datum.key.stk2", "as": "stk2"},
                                        {"type": "formula", "expr": "datum.doc_count", "as": "size"}
                                    ]
                                    },
                                    {
                                    "name": "nodes",
                                    "source": "emission_types",
                                    "transform": [
                                        {
                                        "type": "filter",
                                        "expr": "!groupSelector || groupSelector.stk1 == datum.stk1 || groupSelector.stk2 == datum.stk2"
                                        },
                                        {"type": "formula", "expr": "datum.stk1+datum.stk2", "as": "key"},
                                        {"type": "fold", "fields": ["stk1", "stk2"], "as": ["stack", "grpId"]},
                                        {
                                        "type": "formula",
                                        "expr": "datum.stack == 'stk1' ? datum.stk1+' '+datum.stk2 : datum.stk2+' '+datum.stk1",
                                        "as": "sortField"
                                        },
                                        {
                                        "type": "stack",
                                        "groupby": ["stack"],
                                        "sort": {"field": "sortField", "order": "descending"},
                                        "field": "size"
                                        },
                                        {"type": "formula", "expr": "(datum.y0+datum.y1)/2", "as": "yc"}
                                    ]
                                    },
                                    {
                                    "name": "groups",
                                    "source": "nodes",
                                    "transform": [
                                        {
                                        "type": "aggregate",
                                        "groupby": ["stack", "grpId"],
                                        "fields": ["size"],
                                        "ops": ["sum"],
                                        "as": ["total"]
                                        },
                                        {
                                        "type": "stack",
                                        "groupby": ["stack"],
                                        "sort": {"field": "grpId", "order": "descending"},
                                        "field": "total"
                                        },
                                        {"type": "formula", "expr": "scale('y', datum.y0)", "as": "scaledY0"},
                                        {"type": "formula", "expr": "scale('y', datum.y1)", "as": "scaledY1"},
                                        {
                                        "type": "formula",
                                        "expr": "datum.stack == 'stk1'",
                                        "as": "rightLabel"
                                        },
                                        {
                                        "type": "formula",
                                        "expr": "datum.total/domain('y')[1]",
                                        "as": "percentage"
                                        }
                                    ]
                                    },
                                    {
                                    "name": "destinationNodes",
                                    "source": "nodes",
                                    "transform": [{"type": "filter", "expr": "datum.stack == 'stk2'"}]
                                    },
                                    {
                                    "name": "edges",
                                    "source": "nodes",
                                    "transform": [
                                        {"type": "filter", "expr": "datum.stack == 'stk1'"},
                                        {
                                        "type": "lookup",
                                        "from": "destinationNodes",
                                        "key": "key",
                                        "fields": ["key"],
                                        "as": ["target"]
                                        },
                                        {
                                        "type": "linkpath",
                                        "orient": "horizontal",
                                        "shape": "diagonal",
                                        "sourceY": {"expr": "scale('y', datum.yc)"},
                                        "sourceX": {"expr": "scale('x', 'stk1') + bandwidth('x')"},
                                        "targetY": {"expr": "scale('y', datum.target.yc)"},
                                        "targetX": {"expr": "scale('x', 'stk2')"}
                                        },
                                        {
                                        "type": "formula",
                                        "expr": "range('y')[0]-scale('y', datum.size)",
                                        "as": "strokeWidth"
                                        },
                                        {
                                        "type": "formula",
                                        "expr": "datum.size/domain('y')[1]",
                                        "as": "percentage"
                                        }
                                    ]
                                    }
                                ],
                                "scales": [
                                    {
                                    "name": "x",
                                    "type": "band",
                                    "range": "width",
                                    "domain": ["stk1", "stk2"],
                                    "paddingOuter": 0.05,
                                    "paddingInner": 0.95
                                    },
                                    {
                                    "name": "y",
                                    "type": "linear",
                                    "range": "height",
                                    "domain": {"data": "nodes", "field": "y1"}
                                    },
                                    {
                                    "name": "color",
                                    "type": "ordinal",
                                    "range": [
                                        "#0F0F0F",
                                        "#82C09A",
                                        "#EF798A",
                                        "#F9BF6E",
                                        "#4392F1",
                                        "#724E91"
                                    ],
                                    "domain": {"data": "emission_types", "fields": ["stk1", "stk2"]}
                                    },
                                    {
                                    "name": "stackNames",
                                    "type": "ordinal",
                                    "range": ["Source", "Destination"],
                                    "domain": ["stk1", "stk2"]
                                    }
                                ],
                                "marks": [
                                    {
                                    "type": "path",
                                    "name": "edgeMark",
                                    "from": {"data": "edges"},
                                    "clip": true,
                                    "encode": {
                                        "update": {
                                        "stroke": [
                                            {
                                            "test": "groupSelector && groupSelector.stack=='stk1'",
                                            "scale": "color",
                                            "field": "stk2"
                                            },
                                            {"scale": "color", "field": "stk1"}
                                        ],
                                        "strokeWidth": {"field": "strokeWidth"},
                                        "path": {"field": "path"},
                                        "strokeOpacity": {
                                            "signal": "!groupSelector && (groupHover.stk1 == datum.stk1 || groupHover.stk2 == datum.stk2) ? 0.9 : 0.3"
                                        },
                                        "zindex": {
                                            "signal": "!groupSelector && (groupHover.stk1 == datum.stk1 || groupHover.stk2 == datum.stk2) ? 1 : 0"
                                        },
                                        "tooltip": {
                                            "signal": "datum.stk1 + ' → ' + datum.stk2 + '    ' + format(datum.size, ',.0f') + '   (' + format(datum.percentage, '.1%') + ')'"
                                        }
                                        },
                                        "hover": {"strokeOpacity": {"value": 1}}
                                    }
                                    },
                                    {
                                    "type": "rect",
                                    "name": "groupMark",
                                    "from": {"data": "groups"},
                                    "encode": {
                                        "enter": {
                                        "fill": {"scale": "color", "field": "grpId"},
                                        "width": {"scale": "x", "band": 1}
                                        },
                                        "update": {
                                        "x": {"scale": "x", "field": "stack"},
                                        "y": {"field": "scaledY0"},
                                        "y2": {"field": "scaledY1"},
                                        "fillOpacity": {"value": 1},
                                        "tooltip": {
                                            "signal": "datum.grpId + '   ' + format(datum.total, ',.0f') + '   (' + format(datum.percentage, '.1%') + ')'"
                                        }
                                        },
                                        "hover": {"fillOpacity": {"value": 1}}
                                    }
                                    },
                                    {
                                    "type": "text",
                                    "from": {"data": "groups"},
                                    "interactive": false,
                                    "encode": {
                                        "update": {
                                        "x": {
                                            "signal": "scale('x', datum.stack) + (datum.rightLabel ? bandwidth('x') + 8 : -8)"
                                        },
                                        "yc": {"signal": "(datum.scaledY0 + datum.scaledY1)/2"},
                                        "align": {"signal": "datum.rightLabel ? 'left' : 'right'"},
                                        "baseline": {"value": "middle"},
                                        "fontWeight": {"value": "bold"},
                                        "text": {
                                            "signal": "abs(datum.scaledY0-datum.scaledY1) > 13 ? datum.grpId : ''"
                                        }
                                        }
                                    }
                                    },
                                    {
                                    "type": "group",
                                    "data": [
                                        {
                                        "name": "dataForShowAll",
                                        "values": [{}],
                                        "transform": [{"type": "filter", "expr": "groupSelector"}]
                                        }
                                    ],
                                    "encode": {
                                        "enter": {
                                        "xc": {"signal": "width/2"},
                                        "y": {"value": 30},
                                        "width": {"value": 80},
                                        "height": {"value": 30}
                                        }
                                    },
                                    "marks": [
                                        {
                                        "type": "group",
                                        "name": "groupReset",
                                        "from": {"data": "dataForShowAll"},
                                        "encode": {
                                            "enter": {
                                            "cornerRadius": {"value": 6},
                                            "fill": {"value": "#f5f5f5"},
                                            "stroke": {"value": "#c1c1c1"},
                                            "strokeWidth": {"value": 2},
                                            "height": {"field": {"group": "height"}},
                                            "width": {"field": {"group": "width"}}
                                            },
                                            "update": {"opacity": {"value": 1}},
                                            "hover": {"opacity": {"value": 1}}
                                        },
                                        "marks": [
                                            {
                                            "type": "text",
                                            "interactive": false,
                                            "encode": {
                                                "enter": {
                                                "xc": {"field": {"group": "width"}, "mult": 0.5},
                                                "yc": {
                                                    "field": {"group": "height"},
                                                    "mult": 0.5,
                                                    "offset": -2
                                                },
                                                "align": {"value": "center"},
                                                "baseline": {"value": "middle"},
                                                "fontWeight": {"value": "bold"},
                                                "text": {"value": "Show All"}
                                                }
                                            }
                                            }
                                        ]
                                        }
                                    ]
                                    }
                                ],
                                "signals": [
                                    {
                                    "name": "groupHover",
                                    "value": {},
                                    "on": [
                                        {
                                        "events": "@groupMark:mouseover",
                                        "update": "{stk1:datum.stack=='stk1' && datum.grpId, stk2:datum.stack=='stk2' && datum.grpId}"
                                        },
                                        {"events": "mouseout", "update": "{}"}
                                    ]
                                    },
                                    {
                                    "name": "groupSelector",
                                    "value": false,
                                    "on": [
                                        {
                                        "events": "@groupMark:click!",
                                        "update": "{stack:datum.stack, stk1:datum.stack=='stk1' && datum.grpId, stk2:datum.stack=='stk2' && datum.grpId}"
                                        },
                                        {
                                        "events": [
                                            {"type": "click", "markname": "groupReset"},
                                            {"type": "dblclick"}
                                        ],
                                        "update": "false"
                                        }
                                    ]
                                    }
                                ]
                                }    
                            vegaEmbed('#sources_total', yourVlSpec);
                        </script>
                    <!-- </div> -->
                </div>
                <div class="col-sm-3"></div>
            </div>
        </div>
        <div class="parent-container">
            <div class="row">
                <div class="col">
                    <div class="h1-section-title" style="padding-bottom: 2%;">Our World is <b style="color: red;">Heating up!!!</b></div>
                    <div class="p-section" style="margin-top: 0%;text-align: center;margin-bottom: 2%;">
                        Wouldn't you say that these past few years have felt much warmer? 
                        <br>Ever wondered how much warmer our Earth gets every year?
                    </div>
                </div>
                <div class="col text-center">
                    <div class="h1-section">
                        Yearly Average Global Temperature Change
                    </div>
                </div>
            </div>
            <div class="chart-container">
                <div id="temp_change"></div>
                <script type="text/javascript">
                    var yourVlSpec = 
                    {
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "width": "container",
                        "height": "container",
                        "projection": {
                        "type": "equalEarth",
                        },
                        "params": [
                        {
                            "name": "Year_selection",
                            "value": 1961,
                            "bind": {
                            "input": "range",
                            "min": 1961,
                            "max": 2019,
                            "step": 1,
                            "name": "Year: "
                            }
                        }
                        ],
                        "layer": [
                        {
                            "data": {
                            "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_admin_0_countries.json",
                            "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
                            },
                            "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
                        },
                        {
                            "data": {
                            "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_ocean.topojson",
                            "format": {"type": "topojson", "feature": "oceans"}
                            },
                            "mark": {"type": "geoshape", "fill": "skyblue", "stroke": "null"}
                        },
                        {
                            "data": {
                            "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_graticules_30.json",
                            "format": {"type": "topojson", "feature": "ne_110m_graticules_30"}
                            },
                            "mark": {"type": "geoshape", "fill": null, "stroke": "lightgrey"}
                        },
                        {
                            "data": {
                            "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179A2/main/data/temp_change_clean.csv"
                            },
                            "transform": [
                            {
                                "lookup": "Country",
                                "from": {
                                "data": {
                                    "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179hw10/main/ne_110m_admin_0_countries.json",
                                    "format": {
                                    "type": "topojson",
                                    "feature": "ne_110m_admin_0_countries"
                                    }
                                },
                                "key": "properties.NAME"
                                },
                                "as": "geo"
                            },
                            {"filter": "datum.variable == Year_selection"}
                            ],
                            "mark": {"type": "geoshape"},
                            "encoding": {
                            "description": {"field": "Area"},
                            "shape": {"field": "geo", "type": "geojson"},
                            "color": {
                                "field": "val",
                                "type": "quantitative",
                                "scale": {
                                "scheme": "blueorange",
                                "type": "threshold",
                                "domain":[-0.5,0,0.5,1]
                                },
                                "legend":{
                                    "title":"Temperature change in Celsius",
                                    "orient":"top"
                                }
                            },
                            "tooltip": [
                                {"field": "Country", "type": "nominal", "title": "Country"},
                                {"field": "val", "type": "quantitative","title":"Temperature Change","format":".2f"},
                                {"field": "variable", "type": "quantitative","title":"Year"}
                            ]
                            }
                        },
                        {
                            "data": {
                            "url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179A2/main/data/continents.csv"
                            },
                            "mark": {
                            "type": "text",
                            "color": "black",
                            "fontWeight": "bolder",
                            "fontSize": 11
                            },
                            "encoding": {
                            "text": {"field": "Continent", "type": "nominal"},
                            "latitude": {"field": "Latitude", "type": "quantitative"},
                            "longitude": {"field": "Longitude", "type": "quantitative"}
                            }
                        }
                        ]
                    }
                    vegaEmbed('#temp_change', yourVlSpec);
                </script>
                
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="p-section">
                        Above, we can see the <b>yearly average temperature change</b> for each country. 
                        <br><br>For simplification, 
                        <b style="color: #2596be;">blue</b> means there was a <b>decrease in temperature</b> for that year, 
                        <b style="color: #e08424;">orange</b> means that there was an<b> increase in temperature</b> for that year
                        and <b>white</b> means <b>little to no change in temperature</b> for that year.
                        <br><br>Try moving the Year Slider to observe the change in temperature over time
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="p-section">
                        When you move the slider to increase the years, 
                        We can see a definite trend of temperature change increasing. 
                        This is most evident during the turn of the century, as more and more countries
                        report an increase in temperature
                
                        <br><br>In 2019, we can see almost all countries are reporting an increase of at least 1 degree Celsius for that year,
                        with no countries reporting a decrease and very few countries reporting little to no change in temperature 
                    </div>
                </div>
            </div>
        </div>
        <div class="parent-container">
            <div class="row">
                <div class="col">
                    <div class="h1-section-title">Correlation between CO2 Emissions and Global Temperature</div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="chart-container">
                        <div id="correlation_line"></div>
                        <script type="text/javascript">
                            var yourVlSpec = 
                            {
                                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                                "width": "container",
                                "height": "container",
                                "data": {"url": "https://raw.githubusercontent.com/RyanKoh03/FIT3179A2/main/data/global_emissions_temperature.csv"},
                                "transform": [
                                    {"fold": ["temp_change", "co2_emissions"]}
                                ],
                                "mark": "line",
                                "encoding": {
                                    "x": {"field": "year", "type": "temporal","axis":{
                                    "domain": false,
                                    "grid": false,
                                    "ticks": false
                                    }},
                                    "y": {"field": "value", "type": "quantitative","title":"Change in Emission and Temperature","axis":{
                                    "domain": false,
                                    "grid": false,
                                    "ticks": false
                                    }},
                                    "color": {"field": "key", "type": "nominal","legend":{
                                    "title":"Type",
                                    "labelExpr": "datum.label == 'co2_emissions' ? 'CO2 Emissions' : datum.label == 'temp_change' ? 'Temperature Change' :''" ,
                                    "orient":"left",
                                    "labelFontSize":14,
                                    "titleFontSize":16
                                    }},
                                    "tooltip":[
                                    {"field":"co2_emissions","type": "quantitative","title":"CO2 Emission in kilotons ","format":".2f"},
                                    {"field":"temp_change","type": "quantitative","title":"Temperature change in Celsius","format":".2f"},
                                    {"field":"year","type": "temporal","title":"Year","timeUnit":"binnedutcyear"}
                                    ]
                                }
                                }
                            vegaEmbed('#correlation_line', yourVlSpec);
                        </script>
                    </div>
                </div> 
                <div class="col-sm-6">
                    <div class="child-container">
                        <div class="h1-section">What's the correlation?</div>
                        <p class="p-section">
                            In the line chart on the left, we can see a definite correlation between <b style="color: #2596be;">CO2 emissions</b> and the <b style="color: #e08424;">change in global temperature</b>
                            <br><br>1 unit on the Y-axis represents 1 kiloton of CO2 emission / 1 degree celsius
                            <br><br>We can see a clear <b>increase</b> of both <b style="color: #2596be;">CO2 emissions</b> and <b style="color: #e08424;">temperature</b> as time increases
                            <br><br>The yearly average global temperature increase has changed from <b>0.11</b> degree Celsius to <b>1.37</b> degrees.
                            <br><br>This means our globe averaged an increase of 1.37 degrees Celsius worldwide in 2019
                            <br><br>This is a clear indication of CO2 Emissions having an adverse effect on the global temperature
                            <br><br>Next, let's explore the top 5 countries 
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
